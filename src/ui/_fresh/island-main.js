import{a as f,b as g,d,e as v}from"./chunk-35PY5JX4.js";import{a as m}from"./chunk-DD3V6ZYS.js";var b=0,S=Array.isArray;function e(a,s,n,r,u,i){s||(s={});var o,l,t=s;if("ref"in t)for(l in t={},s)l=="ref"?o=s[l]:t[l]=s[l];var c={type:a,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--b,__i:-1,__u:0,__source:u,__self:i};if(typeof a=="function"&&(o=a.defaultProps))for(l in o)t[l]===void 0&&(t[l]=o[l]);return m.vnode&&m.vnode(c),c}function x(){let a=d(void 0),s=d(!1);return e("div",{className:"container mx-auto p-6",children:e("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e("div",{className:"md:col-span-1 bg-gray-800 rounded-xl shadow-lg p-6",children:[e("h2",{className:"text-2xl font-bold mb-4 text-gray-100 border-b border-gray-700 pb-2",children:"Applications"}),e(y,{currentApp:a,showAcceptButton:s})]}),e("div",{className:"md:col-span-2 bg-gray-800 rounded-xl shadow-lg p-6",children:a.value?e(w,{name:a,showAcceptButton:s}):e("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-24 w-24 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e("p",{className:"text-xl",children:"Select an application to manage permissions"})]})})]})})}function y({currentApp:a,showAcceptButton:s}){let n=t=>{s.value=!1,a.value=t},r=d([]),u=d(!0),[i,o]=f("");g(()=>{fetch("/api/apps").then(t=>t.json()).then(t=>{r.value=t,u.value=!1}).catch(()=>{u.value=!1})},[]);let l=r.value?.filter(t=>t.toLowerCase().includes(i.toLowerCase()));return u.value?e("div",{className:"flex justify-center p-8",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"})}):e("div",{className:"flex flex-col gap-4",children:[e("div",{className:"relative",children:[e("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e("svg",{className:"w-4 h-4 text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:e("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})})}),e("input",{type:"search",className:"block w-full p-2 pl-10 text-sm bg-gray-700 border border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-white placeholder-gray-400",placeholder:"Search applications...",value:i,onInput:t=>o(t.target.value)}),i&&e("button",{type:"button",className:"absolute inset-y-0 right-0 flex items-center pr-3",onClick:()=>o(""),children:e("svg",{className:"w-4 h-4 text-gray-400 hover:text-white","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e("div",{className:"flex flex-col gap-2 max-h-[65vh] overflow-y-auto pr-2",children:l?.length===0?e("div",{className:"text-gray-400 text-center py-4",children:i?e("p",{children:"No applications match your search"}):e("p",{children:"No applications found"})}):l?.map(t=>{let c=a.value===t;return e("button",{type:"button",onClick:()=>n(t),className:`flex items-center p-3 rounded-lg transition-all text-left ${c?"bg-blue-600 text-white shadow-md":"bg-gray-700 text-gray-200 hover:bg-gray-600"}`,children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e("span",{className:"font-medium truncate",children:t})]},t)})})]})}function w({name:a,showAcceptButton:s}){let n=d(void 0),r=d(!0),u=d(!1);v(()=>{r.value=!0,fetch("/api/apps",{method:"POST",body:JSON.stringify({method:"getPermission",name:a.value})}).then(o=>o.json()).then(o=>{n.value=o,r.value=!1}).catch(()=>{r.value=!1})});let i=()=>{n.value&&fetch("/api/apps",{method:"POST",body:JSON.stringify({method:"updatePermission",name:a.value,permissionMap:n.value})}).then(()=>{s.value=!1,u.value=!0,setTimeout(()=>{u.value=!1},3e3)})};return r.value?e("div",{className:"flex justify-center items-center h-full",children:e("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-400"})}):e("div",{className:"flex flex-col h-full",children:[e("div",{className:"flex justify-between items-center border-b border-gray-700 pb-4 mb-4",children:[e("h2",{className:"text-2xl font-bold text-gray-100 flex items-center",children:[e("span",{children:a.value}),u.value&&e("span",{className:"ml-4 text-sm font-normal text-green-400 bg-green-900/50 py-1 px-3 rounded-full animate-pulse",children:"Permissions saved successfully"})]}),s.value&&e("button",{type:"button",onClick:i,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Changes"]})]}),n.value&&e("div",{className:"space-y-5 overflow-y-auto pr-2",children:[e("div",{className:"bg-blue-900/30 rounded-lg p-4 mb-6 text-blue-300 text-sm border border-blue-800/50",children:"Configure permissions for this application. Enable or disable specific permissions and set allowed paths or domains."}),e(p,{name:"All",icon:"\u{1F511}",description:"All permissions",permission:n.value.all,pendingChanges:s}),e(p,{name:"Read",icon:"\u{1F4C1}",description:"Read from file system",permission:n.value.read,pendingChanges:s}),e(p,{name:"Write",icon:"\u{1F4BE}",description:"Write to file system",permission:n.value.write,pendingChanges:s}),e(p,{name:"Env",icon:"\u{1F527}",description:"Access environment variables",permission:n.value.env,pendingChanges:s}),e(p,{name:"Run",icon:"\u25B6\uFE0F",description:"Execute subprocesses",permission:n.value.run,pendingChanges:s}),e(p,{name:"Net",icon:"\u{1F310}",description:"Network access",permission:n.value.net,pendingChanges:s}),e(p,{name:"FFI",icon:"\u{1F504}",description:"Foreign Function Interface",permission:n.value.ffi,pendingChanges:s}),e(p,{name:"Sys",icon:"\u2699\uFE0F",description:"System information access",permission:n.value.sys,pendingChanges:s})]})]})}function p({name:a,icon:s,description:n,permission:r,pendingChanges:u}){let[i,o]=f(r.allowed),l=()=>{let c=!i;o(c),u.value=!0,r.allowed=c},t=c=>{u.value=!0,r.entries=c.target.value?c.target.value.split(","):void 0};return g(()=>{o(r.allowed)},[r.allowed]),e("div",{className:`border ${i?"border-gray-600 bg-gray-700":"border-gray-700 bg-gray-750"} rounded-lg p-4 transition-colors`,children:[e("div",{className:"flex justify-between items-center mb-2",children:[e("div",{className:"flex items-center",children:[e("span",{className:"mr-2 text-lg",children:s}),e("div",{children:[e("h3",{className:"font-semibold text-gray-200",children:a}),e("p",{className:"text-sm text-gray-400",children:n})]})]}),e("button",{onClick:l,className:`relative inline-flex h-6 w-11 items-center rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 ${i?"bg-blue-600":"bg-gray-500"}`,role:"switch","aria-checked":i,type:"button",children:[e("span",{className:"sr-only",children:"Toggle permission"}),e("span",{className:`${i?"translate-x-5":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})]})]}),i&&e("div",{className:"mt-3",children:[e("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Allowed paths or domains (comma separated)"}),a!=="All"&&e("input",{onInput:t,type:"text",className:"block w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-gray-200",placeholder:`Enter allowed ${a.toLowerCase()} paths or patterns`,value:r.entries?r.entries.join(","):""})]})]})}export{x as default};
